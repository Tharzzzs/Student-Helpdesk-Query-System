<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dashboard</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'pos_app/css/dashboardStyle.css' %}">
</head>
<body>

  <header>
    <h1>EduAssist Dashboard</h1>
    <nav>
      <a href="{% url 'profile' %}">Profile</a>
      {% if user.is_staff %}
        <a href="{% url 'admin_dashboard' %}">Admin Panel</a>
      {% endif %}
      <a href="{% url 'add_request' %}">New Request</a>
      <a href="{% url 'logout' %}">Logout</a>
    </nav>
  </header>

  <div class="container">
    <div class="top-actions">
      <a href="{% url 'add_request' %}">Add New Request</a>
      <input type="text" id="search" placeholder="ðŸ” Search requests..." onkeyup="filterTable()">
    </div>

    {% if user.is_staff %}
      <h2>All Requests (Admin View)</h2>
    {% else %}
      <h2>My Requests</h2>
    {% endif %}

    {% if requests %}
      <table id="requestsTable">
        <thead>
          <tr>
            <!-- <th>ID</th> -->
            <th>Title</th>
            <th>Status</th>
            <th>Date</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for req in requests %}
          <tr>
            <!-- <td>{{ req.id }}</td> -->
            <td>{{ req.title }}</td>
            <td><span class="status {{ req.status }}">{{ req.status }}</span></td>
            <td>{{ req.date }}</td>
            <td>
              <a class="view-btn" href="{% url 'request_detail' req.id %}">View</a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p class="empty">No requests available. Click "Add New Request" to create one.</p>
    {% endif %}
  </div>

  <script>
    function filterTable() {
      const input = document.getElementById("search").value.toLowerCase();
      const rows = document.querySelectorAll("#requestsTable tbody tr");
      rows.forEach(row => {
        row.style.display = row.innerText.toLowerCase().includes(input) ? "" : "none";
      });
    }
  </script>

</body>
</html>
